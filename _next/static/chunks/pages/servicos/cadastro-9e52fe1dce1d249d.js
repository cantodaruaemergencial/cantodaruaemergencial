(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[554],{8152:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/servicos/cadastro",function(){return t(2900)}])},4101:function(e,n,t){"use strict";t.d(n,{Z:function(){return X}});var r=t(7297),o=t(5893),a=t(253),i=t(282),l=t(7536),s=t(9521),u=t(2318),c=t(6050),d=t(9432),f=t(7397),p=t(7083),m=t(7702),h=t(553),b=t(5625),x=t(5432),Z=t(8041),v=t(4486);let g={required:"Campo obrigat\xf3rio.",invalidDate:"Formato de data inv\xe1lido.",maxDate:"A data n\xe3o deve exceder a data m\xe1xima."};function y(){let e=(0,r.Z)(["\n  margin-bottom: 1.5rem;\n"]);return y=function(){return e},e}function w(){let e=(0,r.Z)(["\n  width: 100%;\n"]);return w=function(){return e},e}function _(){let e=(0,r.Z)(["\n  width: 100%;\n\n  .MuiInputAdornment-root {\n    display: none;\n  }\n"]);return _=function(){return e},e}function j(){let e=(0,r.Z)(["\n  color: rgba(0, 0, 0, 0.4);\n"]);return j=function(){return e},e}let C=(0,s.ZP)(a.Z).withConfig({componentId:"sc-c6208d8c-0"})(y()),D=(0,s.ZP)(d.Z).withConfig({componentId:"sc-c6208d8c-1"})(w()),P=(0,s.ZP)(Z.e).withConfig({componentId:"sc-c6208d8c-2"})(_()),I=(0,s.ZP)(x.Z).withConfig({componentId:"sc-c6208d8c-3"})(j()),S=e=>{let{field:{property:n,label:t,description:r,type:a,options:i,rules:s,inputConfig:u,dateConfig:c,disabled:d},control:x,className:Z}=e,y=t+((null==s?void 0:s.required)?" *":""),w=e=>e&&(e.message||g[e.type])||null,_=()=>r?(0,o.jsx)(f.Z,{position:"end",children:(0,o.jsx)(p.ZP,{title:r||"",children:(0,o.jsx)(I,{fontSize:"small"})})}):null,j=e=>{let{field:n,fieldState:{error:t}}=e,r=a===v.f.number?"number":"text";return(0,o.jsx)(D,{...n,label:y,type:r,variant:"outlined",error:!!t,helperText:w(t),disabled:!0===d,inputProps:{maxLength:null==u?void 0:u.maxLength},InputProps:{endAdornment:_()}})},S=e=>{let{field:n,fieldState:{error:t}}=e,r=a===v.f.selectMultiple;return(0,o.jsx)(D,{...n,label:y,variant:"outlined",error:!!t,helperText:w(t),SelectProps:{multiple:r},select:!0,children:null==i?void 0:i.map(e=>(0,o.jsx)(m.Z,{value:e.value,children:e.label},e.value))})},M=e=>{let{field:n}=e;return(0,o.jsx)(P,{...n,label:y,format:"DD/MM/YYYY",inputVariant:"outlined",invalidDateMessage:g.invalidDate,maxDateMessage:g.maxDate,disableFuture:(null==c?void 0:c.disableFuture)||!1,disabled:d})},N=e=>{let{field:n}=e;return(0,o.jsx)(h.Z,{control:(0,o.jsx)(b.Z,{...n,color:"primary",checked:(null==n?void 0:n.value)===!0}),label:y})},q=()=>{switch(a){case v.f.boolean:return N;case v.f.select:case v.f.selectMultiple:return S;case v.f.date:return M;case v.f.number:case v.f.input:default:return j}};return(0,o.jsx)(C,{className:Z,children:(0,o.jsx)(l.Qr,{name:n,control:x,rules:s,render:e=>{let{field:n,fieldState:t}=e;return q()({field:n,fieldState:t})}})})};function M(){let e=(0,r.Z)(["\n  margin-bottom: 1rem;\n"]);return M=function(){return e},e}function N(){let e=(0,r.Z)(["\n  && {\n    margin-bottom: 2rem;\n  }\n"]);return N=function(){return e},e}let q=(0,s.ZP)(c.Z).withConfig({componentId:"sc-9d76d6d3-0"})(M()),A=(0,s.ZP)(u.Z).withConfig({componentId:"sc-9d76d6d3-1"})(N()),E=e=>{let{section:{label:n,fields:t},control:r,className:a}=e;return(0,o.jsxs)(q,{className:a,children:[(0,o.jsx)(A,{variant:"h4",children:n}),t.map(e=>(0,o.jsx)(S,{field:e,control:r},e.property))]})};var F=t(2425),k=t(7294);function L(){let e=(0,r.Z)([""]);return L=function(){return e},e}function O(){let e=(0,r.Z)(["\n  width: 100%;\n"]);return O=function(){return e},e}function Y(){let e=(0,r.Z)(["\n  display: flex;\n  justify-content: flex-end;\n  padding: 2rem 0 3rem;\n"]);return Y=function(){return e},e}function R(){let e=(0,r.Z)(["\n  width: 200px;\n"]);return R=function(){return e},e}let T=(0,s.ZP)(a.Z).withConfig({componentId:"sc-55e3eb2e-0"})(L()),B=s.ZP.form.withConfig({componentId:"sc-55e3eb2e-1"})(O()),V=(0,s.ZP)(a.Z).withConfig({componentId:"sc-55e3eb2e-2"})(Y()),z=(0,s.ZP)(i.Z).withConfig({componentId:"sc-55e3eb2e-3"})(R()),H=e=>{let{form:n,onSubmit:t,className:r}=e,{enqueueSnackbar:a}=(0,F.Ds)(),[i,s]=(0,k.useState)(!1),{control:u,handleSubmit:c}=(0,l.cI)({mode:"onSubmit",defaultValues:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t={},r=n=>{if(e&&null!==n.value)return n.value;switch(n.type){case v.f.boolean:return!1;case v.f.selectMultiple:return[];case v.f.select:case v.f.input:case v.f.number:return"";default:return null}};return n.sections.forEach(e=>{e.fields.forEach(e=>{t[e.property]=r(e)})}),t}()}),d=()=>f("Verifique os dados e tente novamente.","error"),f=(e,n)=>a(e,{variant:n}),p=e=>{if(i)return null;s(!0),t(e).then(e=>{e&&f(e,"success")}).catch(e=>{e&&f(e,"error")}).finally(()=>{s(!1)})};return(0,o.jsx)(T,{className:r,children:(0,o.jsxs)(B,{onSubmit:c(p,d),children:[n.sections.map(e=>(0,o.jsx)(E,{section:e,control:u},e.label)),(0,o.jsx)(V,{children:(0,o.jsx)(z,{id:"saveButton",variant:"contained",color:"primary",type:"submit",disabled:i,children:i?"Salvando...":"Salvar"})})]})})};var X=H},2900:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return F}});var r=t(7297),o=t(5893),a=t(370),i=t(6598),l=t(3832),s=t(2318),u=t(253),c=t(9521),d=t(475),f=t(7294),p=t(4101),m=t(381),h=t(4509),b=t(4486);class x{}x.getAttendancesForm=e=>{var n;let t=[{label:"Atendimento - ".concat(null!==(n=null==e?void 0:e.name)&&void 0!==n?n:""),fields:[{label:"Data de refer\xeancia",property:"service_attendance_date",value:null,type:b.f.date,dateConfig:{disableFuture:!0},rules:{required:!0}},{label:"Precisa de conversa/escuta?",property:"needs_conversation",type:b.f.boolean},{label:"Precisa de telefonema? Descreva",property:"describe_needs_call",rules:{required:!0},inputConfig:{maxLength:150},type:b.f.input},{label:"Demanda sobre sa\xfade? Descreva",property:"describe_needs_health",rules:{required:!0},inputConfig:{maxLength:150},type:b.f.input},{label:"Demanda sobre alimenta\xe7\xe3o?",property:"describe_needs_food",type:b.f.boolean},{label:"Demanda sobre trabalho? Descreva",property:"describe_needs_work",rules:{required:!0},inputConfig:{maxLength:150},type:b.f.input},{label:"Demanda sobre moradia?",property:"needs_house",type:b.f.boolean},{label:"Demanda sobre rep\xfablica?",property:"needs_temporary_home",type:b.f.boolean},{label:"Demanda sobre documentos?",property:"needs_documents",type:b.f.boolean},{label:"Demanda sobre abrigo/albergue?",property:"needs_shelter",type:b.f.boolean},{label:"Demanda sobre cuidados de higiene?",property:"needs_hygiene_care",type:b.f.boolean},{label:"Outras demandas? Descreva",property:"describe_needs_others",rules:{required:!0},inputConfig:{maxLength:150},type:b.f.input},{label:"Observa\xe7\xf5es",property:"comment",rules:{required:!0},inputConfig:{maxLength:150},type:b.f.input}]}];return{sections:t}},x.saveAttendancesByDay=async(e,n,t)=>{let r={...e};Object.keys(r).forEach(e=>{if((0,m.isMoment)(r[e])){let n=r[e];r[e]=n.format("YYYY-MM-DD HH:mm:ss")}});let o={...r,person:null==t?void 0:t.id,user:null==n?void 0:n.id},{status:a,data:i}=await h.V0.post("pastoral-de-rua-service-attendances",o);if(200!==a)throw Error();return{data:i}};var Z=t(6975),v=t(8757),g=t(6248),y=t(2904),w=t(1872),_=t(3129);function j(){let e=(0,r.Z)(["\n  && {\n    width: 100%;\n  }\n\n  "," {\n    max-width: 600px;\n  }\n"]);return j=function(){return e},e}function C(){let e=(0,r.Z)(["\n  margin-bottom: 8px;\n  font-weight: 600;\n"]);return C=function(){return e},e}function D(){let e=(0,r.Z)(["\n  flex: 1;\n  width: 100%;\n"]);return D=function(){return e},e}function P(){let e=(0,r.Z)(["\n  height: 220px;\n  margin: 32px 0px;\n"]);return P=function(){return e},e}function I(){let e=(0,r.Z)(["\n  flex: 1;\n"]);return I=function(){return e},e}let S=(0,i.Z)((0,c.ZP)(l.Z).withConfig({componentId:"sc-41c62d72-0"})(j(),e=>{let{theme:n}=e;return n.breakpoints.down("sm")})),M=(0,c.ZP)(s.Z).withConfig({componentId:"sc-41c62d72-1"})(C()),N=(0,c.ZP)(g.Z).withConfig({componentId:"sc-41c62d72-2"})(D()),q=(0,c.ZP)(u.Z).withConfig({componentId:"sc-41c62d72-3"})(P()),A=(0,c.ZP)(Z.Z).withConfig({componentId:"sc-41c62d72-4"})(I()),E=()=>{let[e,n]=(0,f.useState)(null),[t,r]=(0,f.useState)(void 0),[i,l]=(0,f.useState)({}),{userProfile:s}=(0,w.F_)(),u=(e,n,t)=>v.Z.get(e,n,t);(0,f.useEffect)(()=>{let e=x.getAttendancesForm(t);n(e)},[t]);let c=async e=>new Promise((o,a)=>{x.saveAttendancesByDay(e,s,t).then(e=>{null!==e?(o("Servi\xe7o atualizado com sucesso!"),n(x.getAttendancesForm()),r(void 0),l({nameOrCardNumber:""})):o(null)}).catch(()=>{a("Ocorreu um erro. Tente novamente.")})}),m=e=>l({nameOrCardNumber:e}),h=(e,n,a)=>(0,o.jsx)(y.Z,{item:e,isRowLoaded:n,props:a,selectedPerson:t,selectPerson:r});return(null==s?void 0:s.associations.some(e=>e.name.includes(_.j.PastoralDeRua)))?(0,o.jsx)(a.Z,{title:"Cadastro - Canto da Rua",children:(0,o.jsxs)(S,{children:[(0,o.jsx)(d.Z,{title:"Cadastro de Atendimentos"}),(0,o.jsx)(M,{children:"Busque e selecione a pessoa a ser atendida:"}),(0,o.jsx)(N,{placeholder:"Nome ou cart\xe3o",onFilter:m}),(0,o.jsx)(q,{children:(0,o.jsx)(A,{fetchRows:u,rowRenderer:h,filter:i})}),e&&t&&(0,o.jsx)(p.Z,{form:e,onSubmit:c})]})}):(0,o.jsx)("h1",{children:"Sem permiss\xe3o para acessar a p\xe1gina"})};var F=E}},function(e){e.O(0,[29,970,465,937,682,529,874,859,650,774,888,179],function(){return e(e.s=8152)}),_N_E=e.O()}]);