(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[570],{7288:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pessoas",function(){return t(2081)}])},2081:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return n0}});var r,o,l=t(5893),a=t(370),s=t(7297),i=t(6050),c=t(6631),u=t(3637),d=t(6083),f=t(9525),h=t(2318),x=t(6856),Z=t(4740);let m=n=>{let{title:e,message:t,open:r,handleClose:o,actions:a,className:s}=n;return(0,l.jsxs)(c.Z,{className:s,onClose:o,open:r,TransitionComponent:u.Z,maxWidth:"xs",children:[(0,l.jsx)(d.Z,{children:e}),(0,l.jsx)(f.Z,{dividers:!0,children:(0,l.jsx)(h.Z,{gutterBottom:!0,children:(0,l.jsx)(Z.D,{children:t||""})})}),(0,l.jsx)(x.Z,{children:a})]})};var g=t(253),p=t(5575),j=t(6977),b=t(9521);function w(){let n=(0,s.Z)(["\n  background-color: rgba(0, 0, 0, 0.05);\n  padding: 0.2rem 0.4rem;\n  border-radius: 4px;\n  grid-area: search;\n\n  .MuiSvgIcon-root {\n    margin: 0 0.5rem;\n    fill: darkgray;\n  }\n"]);return w=function(){return n},n}function v(){let n=(0,s.Z)(["\n  width: 100%;\n"]);return v=function(){return n},n}let k=(0,b.ZP)(g.Z)(w()),P=(0,b.ZP)(p.Z)(v()),y=n=>{let{placeholder:e,onFilter:t,className:r}=n,o=n=>{let{key:e,target:{value:r}}=n;if("Enter"===e){var o;t(r),null===(o=document.getElementById("search-field"))||void 0===o||o.select()}};return(0,l.jsx)(k,{className:r,children:(0,l.jsx)(P,{id:"search-field",placeholder:e,startAdornment:(0,l.jsx)(j.Z,{}),onKeyDown:n=>o(n),onFocus:n=>n.target.select(),autoFocus:!0})})};var E=t(3490),C=t(4509);class N{}N.post=async n=>{let e={person:n.Id,DateTime:new Date};return C.V0.post("/person-entrances",e)};var R=t(8757),S=t(2293),D=t(3832),I=t(282),_=t(6598),M=t(8736),T=t(1664),L=t.n(T),z=t(9186),O=t(7294),H=t(6849);function B(){let n=(0,s.Z)(["\n  justify-content: center;\n  align-items: center;\n  display: flex;\n  height: 100%;\n"]);return B=function(){return n},n}function F(){let n=(0,s.Z)(["\n  && {\n    font-weight: bold;\n  }\n"]);return F=function(){return n},n}let Y=(0,b.ZP)(g.Z)(B()),q=(0,b.ZP)(h.Z)(F()),V=n=>{let{message:e="Nenhum resultado encontrado.",className:t}=n;return(0,l.jsx)(Y,{className:t,children:(0,l.jsx)(q,{children:e})})},W=H.qj,X=H.Z8,A=H.b2,K=H.aV,G=n=>{let{fetchRows:e,rowRenderer:t,filter:r,className:o}=n,[a,s]=(0,O.useState)([]),[i,c]=(0,O.useState)(!0),u=null,d=i?a.length+8:a.length,f=(0,O.useMemo)(()=>new H.t1({fixedWidth:!0,minHeight:50}),[]),h=n=>{let{index:e}=n;return Boolean(a[e])},x=n=>{let{index:e}=n;return a[e]},Z=()=>{s([]),c(!0),u&&u.resetLoadMoreRowsCache()},m=n=>{let{startIndex:t,stopIndex:o}=n;return e(t,o-t,r).then(n=>{c(n.length>0),s([...a,...n])})},p=n=>{let{key:e,index:r,parent:o,style:a}=n;return(0,l.jsx)(X,{cache:f,columnIndex:0,rowIndex:r,parent:o,children:e=>{let{measure:r,registerChild:o}=e;return(0,l.jsx)(g.Z,{onLoad:r,ref:o,style:a,children:t(x(n),h(n),n)})}},e)};return(0,O.useEffect)(()=>{let n=0===Object.keys(r).length;n||Z()},[r]),(0,l.jsx)(A,{isRowLoaded:h,loadMoreRows:m,rowCount:d,className:o,ref:n=>{u=n},children:n=>{let{onRowsRendered:e,registerChild:t}=n;return(0,l.jsx)(W,{children:n=>{let{height:r,width:o}=n;return(0,l.jsx)(K,{tabIndex:-1,ref:t,onRowsRendered:e,rowCount:d,noRowsRenderer:()=>(0,l.jsx)(V,{}),rowRenderer:p,deferredMeasurementCache:f,rowHeight:f.rowHeight,height:r,width:o})}})}})};var J=t(475),Q=t(6182),U=t(6204),$=t(7083),nn=t(1568),ne=t(886),nt=t(4384),nr=t(4779),no=t(8365),nl=t(6010);function na(){let n=(0,s.Z)(["\n  &.success {\n    background-color: ",";\n    color: ",";\n\n    .MuiSvgIcon-root {\n      fill: ",";\n    }\n  }\n\n  &.error {\n    background-color: ",";\n    color: ",";\n\n    .MuiSvgIcon-root {\n      fill: ",";\n    }\n  }\n\n  &.info {\n    background-color: ",";\n    color: ",";\n\n    .MuiSvgIcon-root {\n      fill: ",";\n    }\n  }\n\n  &.MuiChip-sizeSmall {\n    && {\n      font-weight: 600;\n      font-size: 0.65rem;\n    }\n  }\n"]);return na=function(){return n},n}function ns(){let n=(0,s.Z)(["\n  && {\n    border-radius: 24px;\n  }\n"]);return ns=function(){return n},n}(r=o||(o={}))[r.default=0]="default",r[r.success=1]="success",r[r.error=2]="error",r[r.info=3]="info",r[r.disabled=4]="disabled";let ni=(0,_.Z)((0,b.ZP)(U.Z)(na(),n=>{let{theme:e}=n;return"".concat(e.palette.success.light,"30")},n=>{let{theme:e}=n;return e.palette.success.dark},n=>{let{theme:e}=n;return e.palette.success.dark},n=>{let{theme:e}=n;return"".concat(e.palette.error.light,"30")},n=>{let{theme:e}=n;return e.palette.error.dark},n=>{let{theme:e}=n;return e.palette.error.dark},n=>{let{theme:e}=n;return"".concat(e.palette.info.light,"30")},n=>{let{theme:e}=n;return e.palette.info.dark},n=>{let{theme:e}=n;return e.palette.info.dark})),nc=(0,b.ZP)(no.Z)(ns()),nu=n=>{let{label:e,color:t,className:r,loading:a=!1,tooltip:s}=n;if(a)return(0,l.jsx)(nc,{variant:"rect",width:100,height:24});let i=()=>{switch(t){case o.success:return(0,l.jsx)(nn.Z,{});case o.info:return(0,l.jsx)(ne.Z,{});case o.error:return(0,l.jsx)(nt.Z,{});case o.disabled:return(0,l.jsx)(nr.Z,{});default:return null}},c=()=>({default:o.default===t,success:o.success===t,error:o.error===t,info:o.info===t,disabled:o.disabled===t});return s?(0,l.jsx)($.ZP,{title:s,children:(0,l.jsx)(ni,{className:(0,nl.Z)(r,c()),label:e,avatar:i(),size:"small"})}):(0,l.jsx)(ni,{className:(0,nl.Z)(r,c()),label:e,avatar:i(),size:"small"})};var nd=t(4576),nf=t(381),nh=t.n(nf);function nx(){let n=(0,s.Z)(["\n  && {\n    padding: .1rem .5rem;\n    border-radius: 4px;\n    font-weight: 600;\n    text-align: center;\n    font-size: .8rem;\n  }\n  \n  color: rgba(0, 0, 0, 0.87);\n  background-color: #e0e0e0;\n\n  &.success {\n    background-color: ",";\n    color: ",";\n  }\n\n  &.error {\n    background-color: ",";\n    color: ",";\n  }\n\n  &.info {\n    background-color: ",";\n    color: ",";\n  }\n"]);return nx=function(){return n},n}let nZ=(0,_.Z)((0,b.ZP)(g.Z)(nx(),n=>{let{theme:e}=n;return"".concat(e.palette.success.light,"30")},n=>{let{theme:e}=n;return e.palette.success.dark},n=>{let{theme:e}=n;return"".concat(e.palette.error.light,"30")},n=>{let{theme:e}=n;return e.palette.error.dark},n=>{let{theme:e}=n;return"".concat(e.palette.info.light,"30")},n=>{let{theme:e}=n;return e.palette.info.dark})),nm=n=>{let{label:e,color:t,className:r}=n;return(0,l.jsx)(nZ,{className:(0,nl.Z)(r,{default:o.default===t,success:o.success===t,error:o.error===t,info:o.info===t,disabled:o.disabled===t}),children:e})};var ng=t(9932);function np(){let n=(0,s.Z)(["\n  flex: 0 0 auto;\n  height: 100%;\n"]);return np=function(){return n},n}function nj(){let n=(0,s.Z)(["\n  display: flex;\n  align-items: center;\n  height: 100%;\n  width: 100%;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.1);\n  padding: 1.5rem 2rem;\n\n  "," {\n    flex-direction: column;\n    align-items: stretch;\n  }\n\n  &:hover {\n    background-color: rgba(0, 0, 0, 0.05);\n  }\n"]);return nj=function(){return n},n}function nb(){let n=(0,s.Z)(["\n  display: flex;\n  align-items: center;\n  height: 100%;\n  flex: 1;\n\n  "," {\n    margin-bottom: 0.75rem;\n  }\n"]);return nb=function(){return n},n}function nw(){let n=(0,s.Z)(["\n  && {\n    font-weight: 600;\n    cursor: pointer;\n\n    &:hover {\n      text-decoration: underline;\n    }\n\n    "," {\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n  }\n"]);return nw=function(){return n},n}function nv(){let n=(0,s.Z)(["\n  display: flex;\n  flex-direction: column;\n  padding: 0 0.75rem;\n  flex: 1;\n\n  "," {\n    width: 90%;\n  }\n"]);return nv=function(){return n},n}function nk(){let n=(0,s.Z)(["\n  display: grid;\n  grid-auto-flow: column;\n  grid-gap: 1rem;\n  justify-content: space-between;\n  align-items: center;\n"]);return nk=function(){return n},n}function nP(){let n=(0,s.Z)(["\n  min-width: 48px;\n"]);return nP=function(){return n},n}let ny=(0,b.ZP)(g.Z)(np()),nE=(0,_.Z)((0,b.ZP)(g.Z)(nj(),n=>{let{theme:e}=n;return e.breakpoints.down("xs")})),nC=(0,_.Z)((0,b.ZP)(g.Z)(nb(),n=>{let{theme:e}=n;return e.breakpoints.down("xs")})),nN=(0,_.Z)((0,b.ZP)(h.Z)(nw(),n=>{let{theme:e}=n;return e.breakpoints.down("xs")})),nR=(0,_.Z)((0,b.ZP)(g.Z)(nv(),n=>{let{theme:e}=n;return e.breakpoints.down("xs")})),nS=(0,b.ZP)(g.Z)(nk()),nD=(0,b.ZP)(nm)(nP()),nI=n=>{let{item:e,isRowLoaded:t,addNewEntrance:r,props:{key:a,index:s}}=n;if(!t)return(0,l.jsx)(ny,{children:(0,l.jsxs)(nE,{condensed:!0,children:[(0,l.jsxs)(nC,{children:[(0,l.jsx)(no.Z,{variant:"rect",width:64,height:24}),(0,l.jsx)(nR,{children:(0,l.jsx)(nN,{variant:"body2",children:(0,l.jsx)(no.Z,{variant:"text",width:160})})})]}),(0,l.jsxs)(nS,{children:[(0,l.jsx)(nu,{loading:!0}),(0,l.jsx)(no.Z,{variant:"rect",width:95,height:27})]})]})},"".concat(a,"-").concat(s,"-skeleton"));let{Id:i,Preferential:c,Name:u,SocialName:d,CardNumber:f,EnteredToday:x,LastEntranceDate:Z}=e,[m,g]=(0,O.useState)({LastEntranceDate:Z,EnteredToday:x}),p=()=>m.EnteredToday?o.success:null!==m.LastEntranceDate?o.info:o.disabled,j=n=>g({LastEntranceDate:n.DateTime,EnteredToday:!0}),[b,w]=(0,O.useState)({open:!1,person:null}),v=n=>w({open:!0,person:n}),k=()=>{w({...b,open:!1})};return(0,l.jsxs)(ny,{children:[(0,l.jsxs)(nE,{condensed:!0,children:[(0,l.jsxs)(nC,{children:[(0,l.jsx)(nD,{label:f,color:p()}),(0,l.jsxs)(nR,{children:[(0,l.jsx)(L(),{href:"/pessoas/cadastro/".concat(i),children:(0,l.jsxs)(nN,{variant:"body2",children:[c&&(0,l.jsx)($.ZP,{title:"Preferencial",children:(0,l.jsx)(nd.Z,{style:{fill:"rgb(76, 175, 80)"}})}),u]})}),d&&(0,l.jsx)(h.Z,{variant:"caption",children:d})]})]}),(0,l.jsxs)(nS,{children:[(0,l.jsx)(nu,{label:(()=>{if(null===m.LastEntranceDate)return"Nunca entrou";let n=m.EnteredToday?"Entrou ":"\xdalt. vez ",e=nh()(m.LastEntranceDate).fromNow();return n+e})(),color:p(),tooltip:nh()(m.LastEntranceDate).format("DD/MM/YYYY HH:mm").toString()}),!m.EnteredToday&&(0,l.jsx)(I.Z,{variant:"outlined",size:"small",startIcon:(0,l.jsx)(M.Z,{}),onClick:()=>r(e,j),children:"Entrada"}),(0,l.jsx)(I.Z,{variant:"outlined",size:"small",startIcon:(0,l.jsx)(ne.Z,{}),onClick:async()=>{let n=await R.Z.getPerson(e.Id);v(n)},children:"Cart\xe3o"})]})]}),(0,l.jsx)(ng.Z,{...b,handleClose:k,newPerson:!1})]},i)};var n_=t(1163);function nM(){let n=(0,s.Z)(["\n  && {\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 0;\n    height: 100%;\n    flex: 1;\n  }\n"]);return nM=function(){return n},n}function nT(){let n=(0,s.Z)([""]);return nT=function(){return n},n}function nL(){let n=(0,s.Z)(["\n  grid-area: add-new;\n  height: 42px;\n"]);return nL=function(){return n},n}function nz(){let n=(0,s.Z)(["\n  && {\n    display: flex;\n    flex-direction: column;\n    margin-bottom: 3rem;\n    flex-shrink: 0;\n    padding: 0;\n  }\n"]);return nz=function(){return n},n}function nO(){let n=(0,s.Z)(["\n  height: 70vh;\n"]);return nO=function(){return n},n}function nH(){let n=(0,s.Z)(["\n  flex: 1;\n"]);return nH=function(){return n},n}function nB(){let n=(0,s.Z)(["\n  margin-left: 1rem;\n"]);return nB=function(){return n},n}function nF(){let n=(0,s.Z)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1.5rem 2rem;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.1);\n  box-shadow: ",";\n"]);return nF=function(){return n},n}function nY(){let n=(0,s.Z)(["\n  flex: 1;\n  max-width: 400px;\n"]);return nY=function(){return n},n}let nq=(0,b.ZP)(D.Z)(nM()),nV=(0,_.Z)((0,b.ZP)(J.Z)(nT())),nW=(0,b.ZP)(I.Z)(nL()),nX=(0,b.ZP)(i.Z)(nz()),nA=(0,b.ZP)(g.Z)(nO()),nK=(0,b.ZP)(G)(nH()),nG=(0,b.ZP)(Q.Z)(nB()),nJ=(0,b.ZP)(g.Z)(nF(),S.fo.bottom),nQ=(0,b.ZP)(y)(nY()),nU=()=>{let{enqueueSnackbar:n}=(0,z.Ds)(),e=(0,n_.useRouter)(),[t,r]=(0,O.useState)({});(0,O.useEffect)(()=>r({nameOrCardNumber:e.query.q}),[]);let[o,a]=(0,O.useState)(),[s,i]=(0,O.useState)(),[c,u]=(0,O.useState)(!1),[d,f]=(0,O.useState)({title:"Confirmar entrada",open:!1}),h=(n,e,t)=>R.Z.get(n,e,t),x=()=>E.Z.getToday().then(n=>{let{entrances:e,registers:t}=n;a(e),i(t)}),Z=n=>r({nameOrCardNumber:n}),g=(n,e)=>{let t="Deseja confirmar a entrada de **".concat(n.Name," (").concat(n.CardNumber,")**?");f({...d,data:{person:n,callback:e},message:t,open:!0})},p=()=>{var n;f({...d,open:!1}),null===(n=document.getElementById("search-field"))||void 0===n||n.focus()},j=()=>{u(!0),N.post(d.data.person).then(e=>{let{status:t,data:r}=e;200===t?(p(),d.data.callback(r),x(),u(!1)):(n("Ocorreu um erro ao confirmar a entrada.",{variant:"error"}),u(!1))})};(0,O.useEffect)(()=>{x()},[]);let b=(n,e,t)=>(0,l.jsx)(nI,{item:n,isRowLoaded:e,props:t,addNewEntrance:g});return(0,l.jsxs)(nq,{children:[(0,l.jsx)(nV,{title:"Pessoas",sideComponent:(0,l.jsx)(L(),{href:"/pessoas/cadastro",children:(0,l.jsx)(nW,{variant:"contained",startIcon:(0,l.jsx)(M.Z,{}),children:"Nova Pessoa"})})}),(0,l.jsxs)(nX,{children:[(0,l.jsxs)(nJ,{children:[(0,l.jsx)(nQ,{placeholder:"Nome ou cart\xe3o",onFilter:Z}),(0,l.jsx)(nG,{value:null!=o?o:"-",label:"entradas hoje",medium:!0,alignRight:!0}),(0,l.jsx)(nG,{value:null!=s?s:"-",label:"cadastros hoje",medium:!0,alignRight:!0})]}),(0,l.jsx)(nA,{children:(0,l.jsx)(nK,{fetchRows:h,rowRenderer:b,filter:t})})]}),(0,l.jsx)(m,{...d,handleClose:p,actions:(0,l.jsx)(I.Z,{autoFocus:!0,onClick:j,color:"primary",disabled:c,children:"Confirmar"})})]})},n$=()=>(0,l.jsx)(a.Z,{title:"Pessoas - Canto da Rua",children:(0,l.jsx)(nU,{})});var n0=n$}},function(n){n.O(0,[208,538,575,547,338,711,701,82,733,774,888,179],function(){return n(n.s=7288)}),_N_E=n.O()}]);