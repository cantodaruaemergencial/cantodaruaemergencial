(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[10],{27153:function(n,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pessoas",function(){return r(82081)}])},82081:function(n,e,r){"use strict";r.r(e),r.d(e,{default:function(){return le}});var t=r(85893),o=r(40370),a=r(16050),i=r(86631),c=r(73637),u=r(66083),s=r(29525),l=r(22318),f=r(66856),d=r(38456),h=r.n(d),m=function(n){var e=n.title,r=n.message,o=n.open,a=n.handleClose,d=n.actions,m=n.className;return(0,t.jsxs)(i.Z,{className:m,onClose:a,open:o,TransitionComponent:c.Z,maxWidth:"xs",children:[(0,t.jsx)(u.Z,{children:e}),(0,t.jsx)(s.Z,{dividers:!0,children:(0,t.jsx)(l.Z,{gutterBottom:!0,children:(0,t.jsx)(h(),{children:r||""})})}),(0,t.jsx)(f.Z,{children:d})]})},p=r(50253),v=r(15575),x=r(66977),b=r(10063);function g(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function j(){var n=g(["\n  background-color: rgba(0, 0, 0, 0.05);\n  padding: 0.2rem 0.4rem;\n  border-radius: 4px;\n  grid-area: search;\n\n  .MuiSvgIcon-root {\n    margin: 0 0.5rem;\n    fill: darkgray;\n  }\n"]);return j=function(){return n},n}function w(){var n=g(["\n  width: 100%;\n"]);return w=function(){return n},n}var Z=(0,b.ZP)(p.Z)(j()),y=(0,b.ZP)(v.Z)(w()),P=function(n){var e=n.placeholder,r=n.onFilter,o=n.className;return(0,t.jsx)(Z,{className:o,children:(0,t.jsx)(y,{id:"search-field",placeholder:e,startAdornment:(0,t.jsx)(x.Z,{}),onKeyDown:function(n){return function(n){var e,t=n.key,o=n.target.value;"Enter"===t&&(r(o),null===(e=document.getElementById("search-field"))||void 0===e||e.select())}(n)},onFocus:function(n){return n.target.select()},autoFocus:!0})})},k=r(3490),O=r(34051),E=r.n(O),N=r(14509);function C(n,e,r,t,o,a,i){try{var c=n[a](i),u=c.value}catch(s){return void r(s)}c.done?e(u):Promise.resolve(u).then(t,o)}var S=function n(){!function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n)};S.post=function(){var n,e=(n=E().mark((function n(e){var r;return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={person:e.Id,DateTime:new Date},n.abrupt("return",N.V0.post("/person-entrances",r));case 2:case"end":return n.stop()}}),n)})),function(){var e=this,r=arguments;return new Promise((function(t,o){var a=n.apply(e,r);function i(n){C(a,t,o,i,c,"next",n)}function c(n){C(a,t,o,i,c,"throw",n)}i(void 0)}))});return function(n){return e.apply(this,arguments)}}();var z=S,I=r(58757),R=r(12293),D=r(43832),T=r(282),L=r(46598),M=r(88736),_=r(41664),A=r(29186),F=r(67294),H=r(36849);function q(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function B(){var n=q(["\n  justify-content: center;\n  align-items: center;\n  display: flex;\n  height: 100%;\n"]);return B=function(){return n},n}function Y(){var n=q(["\n  && {\n    font-weight: bold;\n  }\n"]);return Y=function(){return n},n}var V=(0,b.ZP)(p.Z)(B()),W=(0,b.ZP)(l.Z)(Y()),X=function(n){var e=n.message,r=void 0===e?"Nenhum resultado encontrado.":e,o=n.className;return(0,t.jsx)(V,{className:o,children:(0,t.jsx)(W,{children:r})})};function K(n,e){(null==e||e>n.length)&&(e=n.length);for(var r=0,t=new Array(e);r<e;r++)t[r]=n[r];return t}function U(n){return function(n){if(Array.isArray(n))return K(n)}(n)||function(n){if("undefined"!==typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,e){if(!n)return;if("string"===typeof n)return K(n,e);var r=Object.prototype.toString.call(n).slice(8,-1);"Object"===r&&n.constructor&&(r=n.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return K(n,e)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var $,G=function(n){var e=n.fetchRows,r=n.rowRenderer,o=n.filter,a=n.className,i=(0,F.useState)([]),c=i[0],u=i[1],s=(0,F.useState)(!0),l=s[0],f=s[1],d=null,h=l?c.length+8:c.length,m=(0,F.useMemo)((function(){return new H.t1({fixedWidth:!0,minHeight:50})}),[]),v=function(n){var e=n.index;return Boolean(c[e])},x=function(n){var e=n.index;return c[e]},b=function(n){var e=n.key,o=n.index,a=n.parent,i=n.style;return(0,t.jsx)(H.Z8,{cache:m,columnIndex:0,rowIndex:o,parent:a,children:function(e){var o=e.measure,a=e.registerChild;return(0,t.jsx)(p.Z,{onLoad:o,ref:a,style:i,children:r(x(n),v(n),n)})}},e)};return(0,F.useEffect)((function(){0===Object.keys(o).length||(u([]),f(!0),d&&d.resetLoadMoreRowsCache())}),[o]),(0,t.jsx)(H.b2,{isRowLoaded:v,loadMoreRows:function(n){var r=n.startIndex,t=n.stopIndex;return e(r,t-r,o).then((function(n){f(n.length>0),u(U(c).concat(U(n)))}))},rowCount:h,className:a,ref:function(n){d=n},children:function(n){var e=n.onRowsRendered,r=n.registerChild;return(0,t.jsx)(H.qj,{children:function(n){var o=n.height,a=n.width;return(0,t.jsx)(H.aV,{tabIndex:-1,ref:r,onRowsRendered:e,rowCount:h,noRowsRenderer:function(){return(0,t.jsx)(X,{})},rowRenderer:b,deferredMeasurementCache:m,rowHeight:m.rowHeight,height:o,width:a})}})}})},J=r(40475),Q=r(6182),nn=r(16204),en=r(87083),rn=r(11568),tn=r(886),on=r(14384),an=r(54779),cn=r(58365),un=r(86010);function sn(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function ln(){var n=sn(["\n  &.success {\n    background-color: ",";\n    color: ",";\n\n    .MuiSvgIcon-root {\n      fill: ",";\n    }\n  }\n\n  &.error {\n    background-color: ",";\n    color: ",";\n\n    .MuiSvgIcon-root {\n      fill: ",";\n    }\n  }\n\n  &.info {\n    background-color: ",";\n    color: ",";\n\n    .MuiSvgIcon-root {\n      fill: ",";\n    }\n  }\n\n  &.MuiChip-sizeSmall {\n    && {\n      font-weight: 600;\n      font-size: 0.65rem;\n    }\n  }\n"]);return ln=function(){return n},n}function fn(){var n=sn(["\n  && {\n    border-radius: 24px;\n  }\n"]);return fn=function(){return n},n}!function(n){n[n.default=0]="default",n[n.success=1]="success",n[n.error=2]="error",n[n.info=3]="info",n[n.disabled=4]="disabled"}($||($={}));var dn=(0,L.Z)((0,b.ZP)(nn.Z)(ln(),(function(n){var e=n.theme;return"".concat(e.palette.success.light,"30")}),(function(n){return n.theme.palette.success.dark}),(function(n){return n.theme.palette.success.dark}),(function(n){var e=n.theme;return"".concat(e.palette.error.light,"30")}),(function(n){return n.theme.palette.error.dark}),(function(n){return n.theme.palette.error.dark}),(function(n){var e=n.theme;return"".concat(e.palette.info.light,"30")}),(function(n){return n.theme.palette.info.dark}),(function(n){return n.theme.palette.info.dark}))),hn=(0,b.ZP)(cn.Z)(fn()),mn=function(n){var e=n.label,r=n.color,o=n.className,a=n.loading,i=void 0!==a&&a,c=n.tooltip;if(i)return(0,t.jsx)(hn,{variant:"rect",width:100,height:24});var u=function(){switch(r){case $.success:return(0,t.jsx)(rn.Z,{});case $.info:return(0,t.jsx)(tn.Z,{});case $.error:return(0,t.jsx)(on.Z,{});case $.disabled:return(0,t.jsx)(an.Z,{});default:return null}},s=function(){return{default:$.default===r,success:$.success===r,error:$.error===r,info:$.info===r,disabled:$.disabled===r}};return c?(0,t.jsx)(en.ZP,{title:c,children:(0,t.jsx)(dn,{className:(0,un.Z)(o,s()),label:e,avatar:u(),size:"small"})}):(0,t.jsx)(dn,{className:(0,un.Z)(o,s()),label:e,avatar:u(),size:"small"})},pn=r(54576),vn=r(30381),xn=r.n(vn);function bn(){var n,e,r=(n=["\n  && {\n    padding: .1rem .5rem;\n    border-radius: 4px;\n    font-weight: 600;\n    text-align: center;\n    font-size: .8rem;\n  }\n  \n  color: rgba(0, 0, 0, 0.87);\n  background-color: #e0e0e0;\n\n  &.success {\n    background-color: ",";\n    color: ",";\n  }\n\n  &.error {\n    background-color: ",";\n    color: ",";\n  }\n\n  &.info {\n    background-color: ",";\n    color: ",";\n  }\n"],e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}})));return bn=function(){return r},r}var gn=(0,L.Z)((0,b.ZP)(p.Z)(bn(),(function(n){var e=n.theme;return"".concat(e.palette.success.light,"30")}),(function(n){return n.theme.palette.success.dark}),(function(n){var e=n.theme;return"".concat(e.palette.error.light,"30")}),(function(n){return n.theme.palette.error.dark}),(function(n){var e=n.theme;return"".concat(e.palette.info.light,"30")}),(function(n){return n.theme.palette.info.dark}))),jn=function(n){var e=n.label,r=n.color,o=n.className;return(0,t.jsx)(gn,{className:(0,un.Z)(o,{default:$.default===r,success:$.success===r,error:$.error===r,info:$.info===r,disabled:$.disabled===r}),children:e})},wn=r(79932);function Zn(n,e,r,t,o,a,i){try{var c=n[a](i),u=c.value}catch(s){return void r(s)}c.done?e(u):Promise.resolve(u).then(t,o)}function yn(n,e,r){return e in n?Object.defineProperty(n,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[e]=r,n}function Pn(n){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})))),t.forEach((function(e){yn(n,e,r[e])}))}return n}function kn(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function On(){var n=kn(["\n  flex: 0 0 auto;\n  height: 100%;\n"]);return On=function(){return n},n}function En(){var n=kn(["\n  display: flex;\n  align-items: center;\n  height: 100%;\n  width: 100%;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.1);\n  padding: 1.5rem 2rem;\n\n  "," {\n    flex-direction: column;\n    align-items: stretch;\n  }\n\n  &:hover {\n    background-color: rgba(0, 0, 0, 0.05);\n  }\n"]);return En=function(){return n},n}function Nn(){var n=kn(["\n  display: flex;\n  align-items: center;\n  height: 100%;\n  flex: 1;\n\n  "," {\n    margin-bottom: 0.75rem;\n  }\n"]);return Nn=function(){return n},n}function Cn(){var n=kn(["\n  && {\n    font-weight: 600;\n    cursor: pointer;\n\n    &:hover {\n      text-decoration: underline;\n    }\n\n    "," {\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n  }\n"]);return Cn=function(){return n},n}function Sn(){var n=kn(["\n  display: flex;\n  flex-direction: column;\n  padding: 0 0.75rem;\n  flex: 1;\n\n  "," {\n    width: 90%;\n  }\n"]);return Sn=function(){return n},n}function zn(){var n=kn(["\n  display: grid;\n  grid-auto-flow: column;\n  grid-gap: 1rem;\n  justify-content: space-between;\n  align-items: center;\n"]);return zn=function(){return n},n}function In(){var n=kn(["\n  min-width: 48px;\n"]);return In=function(){return n},n}var Rn=(0,b.ZP)(p.Z)(On()),Dn=(0,L.Z)((0,b.ZP)(p.Z)(En(),(function(n){return n.theme.breakpoints.down("xs")}))),Tn=(0,L.Z)((0,b.ZP)(p.Z)(Nn(),(function(n){return n.theme.breakpoints.down("xs")}))),Ln=(0,L.Z)((0,b.ZP)(l.Z)(Cn(),(function(n){return n.theme.breakpoints.down("xs")}))),Mn=(0,L.Z)((0,b.ZP)(p.Z)(Sn(),(function(n){return n.theme.breakpoints.down("xs")}))),_n=(0,b.ZP)(p.Z)(zn()),An=(0,b.ZP)(jn)(In()),Fn=function(n){var e=n.item,r=n.isRowLoaded,o=n.addNewEntrance,a=n.props,i=a.key,c=a.index;if(!r)return(0,t.jsx)(Rn,{children:(0,t.jsxs)(Dn,{condensed:!0,children:[(0,t.jsxs)(Tn,{children:[(0,t.jsx)(cn.Z,{variant:"rect",width:64,height:24}),(0,t.jsx)(Mn,{children:(0,t.jsx)(Ln,{variant:"body2",children:(0,t.jsx)(cn.Z,{variant:"text",width:160})})})]}),(0,t.jsxs)(_n,{children:[(0,t.jsx)(mn,{loading:!0}),(0,t.jsx)(cn.Z,{variant:"rect",width:95,height:27})]})]})},"".concat(i,"-").concat(c,"-skeleton"));var u,s=e.Id,f=e.Preferential,d=e.Name,h=e.SocialName,m=e.CardNumber,p=e.EnteredToday,v=e.LastEntranceDate,x=(0,F.useState)({LastEntranceDate:v,EnteredToday:p}),b=x[0],g=x[1],j=function(){return b.EnteredToday?$.success:null!==b.LastEntranceDate?$.info:$.disabled},w=function(n){return g({LastEntranceDate:n.DateTime,EnteredToday:!0})},Z=(0,F.useState)({open:!1,person:null}),y=Z[0],P=Z[1];return(0,t.jsxs)(Rn,{children:[(0,t.jsxs)(Dn,{condensed:!0,children:[(0,t.jsxs)(Tn,{children:[(0,t.jsx)(An,{label:m,color:j()}),(0,t.jsxs)(Mn,{children:[(0,t.jsx)(_.default,{href:"/pessoas/cadastro/".concat(s),children:(0,t.jsxs)(Ln,{variant:"body2",children:[f&&(0,t.jsx)(en.ZP,{title:"Preferencial",children:(0,t.jsx)(pn.Z,{style:{fill:"rgb(76, 175, 80)"}})}),d]})}),h&&(0,t.jsx)(l.Z,{variant:"caption",children:h})]})]}),(0,t.jsxs)(_n,{children:[(0,t.jsx)(mn,{label:null===b.LastEntranceDate?"Nunca entrou":(b.EnteredToday?"Entrou ":"\xdalt. vez ")+xn()(b.LastEntranceDate).fromNow(),color:j(),tooltip:xn()(b.LastEntranceDate).format("DD/MM/YYYY HH:mm").toString()}),!b.EnteredToday&&(0,t.jsx)(T.Z,{variant:"outlined",size:"small",startIcon:(0,t.jsx)(M.Z,{}),onClick:function(){return o(e,w)},children:"Entrada"}),(0,t.jsx)(T.Z,{variant:"outlined",size:"small",startIcon:(0,t.jsx)(tn.Z,{}),onClick:(u=E().mark((function n(){var r;return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,I.Z.getPerson(e.Id);case 2:r=n.sent,P({open:!0,person:r});case 4:case"end":return n.stop()}}),n)})),function(){var n=this,e=arguments;return new Promise((function(r,t){var o=u.apply(n,e);function a(n){Zn(o,r,t,a,i,"next",n)}function i(n){Zn(o,r,t,a,i,"throw",n)}a(void 0)}))}),children:"Cart\xe3o"})]})]}),(0,t.jsx)(wn.Z,Pn({},y,{handleClose:function(){P(Pn({},y,{open:!1}))},newPerson:!1}))]},s)},Hn=r(11163);function qn(n,e,r){return e in n?Object.defineProperty(n,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[e]=r,n}function Bn(n){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})))),t.forEach((function(e){qn(n,e,r[e])}))}return n}function Yn(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function Vn(){var n=Yn(["\n  && {\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 0;\n    height: 100%;\n    flex: 1;\n  }\n"]);return Vn=function(){return n},n}function Wn(){var n=Yn([""]);return Wn=function(){return n},n}function Xn(){var n=Yn(["\n  grid-area: add-new;\n  height: 42px;\n"]);return Xn=function(){return n},n}function Kn(){var n=Yn(["\n  && {\n    display: flex;\n    flex-direction: column;\n    margin-bottom: 3rem;\n    flex-shrink: 0;\n    padding: 0;\n  }\n"]);return Kn=function(){return n},n}function Un(){var n=Yn(["\n  height: 70vh;\n"]);return Un=function(){return n},n}function $n(){var n=Yn(["\n  flex: 1;\n"]);return $n=function(){return n},n}function Gn(){var n=Yn(["\n  margin-left: 1rem;\n"]);return Gn=function(){return n},n}function Jn(){var n=Yn(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1.5rem 2rem;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.1);\n  box-shadow: ",";\n"]);return Jn=function(){return n},n}function Qn(){var n=Yn(["\n  flex: 1;\n  max-width: 400px;\n"]);return Qn=function(){return n},n}var ne=(0,b.ZP)(D.Z)(Vn()),ee=(0,L.Z)((0,b.ZP)(J.Z)(Wn())),re=(0,b.ZP)(T.Z)(Xn()),te=(0,b.ZP)(a.Z)(Kn()),oe=(0,b.ZP)(p.Z)(Un()),ae=(0,b.ZP)(G)($n()),ie=(0,b.ZP)(Q.Z)(Gn()),ce=(0,b.ZP)(p.Z)(Jn(),R.fo.bottom),ue=(0,b.ZP)(P)(Qn()),se=function(){var n=(0,A.Ds)().enqueueSnackbar,e=(0,Hn.useRouter)(),r=(0,F.useState)({}),o=r[0],a=r[1];(0,F.useEffect)((function(){return a({nameOrCardNumber:e.query.q})}),[]);var i=(0,F.useState)(),c=i[0],u=i[1],s=(0,F.useState)(),l=s[0],f=s[1],d=(0,F.useState)(!1),h=d[0],p=d[1],v=(0,F.useState)({title:"Confirmar entrada",open:!1}),x=v[0],b=v[1],g=function(){return k.Z.getToday().then((function(n){var e=n.entrances,r=n.registers;u(e),f(r)}))},j=function(n,e){var r="Deseja confirmar a entrada de **".concat(n.Name," (").concat(n.CardNumber,")**?");b(Bn({},x,{data:{person:n,callback:e},message:r,open:!0}))},w=function(){var n;b(Bn({},x,{open:!1})),null===(n=document.getElementById("search-field"))||void 0===n||n.focus()};(0,F.useEffect)((function(){g()}),[]);return(0,t.jsxs)(ne,{children:[(0,t.jsx)(ee,{title:"Pessoas",sideComponent:(0,t.jsx)(_.default,{href:"/pessoas/cadastro",children:(0,t.jsx)(re,{variant:"contained",startIcon:(0,t.jsx)(M.Z,{}),children:"Nova Pessoa"})})}),(0,t.jsxs)(te,{children:[(0,t.jsxs)(ce,{children:[(0,t.jsx)(ue,{placeholder:"Nome ou cart\xe3o",onFilter:function(n){return a({nameOrCardNumber:n})}}),(0,t.jsx)(ie,{value:null!=c?c:"-",label:"entradas hoje",medium:!0,alignRight:!0}),(0,t.jsx)(ie,{value:null!=l?l:"-",label:"cadastros hoje",medium:!0,alignRight:!0})]}),(0,t.jsx)(oe,{children:(0,t.jsx)(ae,{fetchRows:function(n,e,r){return I.Z.get(n,e,r)},rowRenderer:function(n,e,r){return(0,t.jsx)(Fn,{item:n,isRowLoaded:e,props:r,addNewEntrance:j})},filter:o})})]}),(0,t.jsx)(m,Bn({},x,{handleClose:w,actions:(0,t.jsx)(T.Z,{autoFocus:!0,onClick:function(){p(!0),z.post(x.data.person).then((function(e){var r=e.status,t=e.data;200===r?(w(),x.data.callback(t),g(),p(!1)):(n("Ocorreu um erro ao confirmar a entrada.",{variant:"error"}),p(!1))}))},color:"primary",disabled:h,children:"Confirmar"})}))]})},le=function(){return(0,t.jsx)(o.Z,{title:"Pessoas - Canto da Rua",children:(0,t.jsx)(se,{})})}}},function(n){n.O(0,[685,538,575,945,338,516,701,82,733,774,888,179],(function(){return e=27153,n(n.s=e);var e}));var e=n.O();_N_E=e}]);