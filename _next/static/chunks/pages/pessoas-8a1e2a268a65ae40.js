(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[570],{7288:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pessoas",function(){return t(2081)}])},2081:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return n0}});var r,o,i=t(5893),a=t(370),s=t(7297),c=t(6050),l=t(6631),d=t(3637),u=t(6083),f=t(9525),h=t(2318),x=t(6856),m=t(4740);let g=n=>{let{title:e,message:t,open:r,handleClose:o,actions:a,className:s}=n;return(0,i.jsxs)(l.Z,{className:s,onClose:o,open:r,TransitionComponent:d.Z,maxWidth:"xs",children:[(0,i.jsx)(u.Z,{children:e}),(0,i.jsx)(f.Z,{dividers:!0,children:(0,i.jsx)(h.Z,{gutterBottom:!0,children:(0,i.jsx)(m.D,{children:t||""})})}),(0,i.jsx)(x.Z,{children:a})]})};var Z=t(253),p=t(5575),b=t(6977),j=t(9521);function w(){let n=(0,s.Z)(["\n  background-color: rgba(0, 0, 0, 0.05);\n  padding: 0.2rem 0.4rem;\n  border-radius: 4px;\n  grid-area: search;\n\n  .MuiSvgIcon-root {\n    margin: 0 0.5rem;\n    fill: darkgray;\n  }\n"]);return w=function(){return n},n}function C(){let n=(0,s.Z)(["\n  width: 100%;\n"]);return C=function(){return n},n}let v=(0,j.ZP)(Z.Z).withConfig({componentId:"sc-261153ef-0"})(w()),I=(0,j.ZP)(p.Z).withConfig({componentId:"sc-261153ef-1"})(C()),k=n=>{let{placeholder:e,onFilter:t,className:r}=n,o=n=>{let{key:e,target:{value:r}}=n;if("Enter"===e){var o;t(r),null===(o=document.getElementById("search-field"))||void 0===o||o.select()}};return(0,i.jsx)(v,{className:r,children:(0,i.jsx)(I,{id:"search-field",placeholder:e,startAdornment:(0,i.jsx)(b.Z,{}),onKeyDown:n=>o(n),onFocus:n=>n.target.select(),autoFocus:!0})})};var P=t(3490),y=t(4509);class E{}E.post=async n=>{let e={person:n.Id,DateTime:new Date};return y.V0.post("/person-entrances",e)};var N=t(8757),R=t(2293),S=t(3832),D=t(282),_=t(6598),M=t(8736),T=t(1664),L=t.n(T),z=t(9186),O=t(7294),H=t(6849);function B(){let n=(0,s.Z)(["\n  justify-content: center;\n  align-items: center;\n  display: flex;\n  height: 100%;\n"]);return B=function(){return n},n}function F(){let n=(0,s.Z)(["\n  && {\n    font-weight: bold;\n  }\n"]);return F=function(){return n},n}let Y=(0,j.ZP)(Z.Z).withConfig({componentId:"sc-90efecb2-0"})(B()),q=(0,j.ZP)(h.Z).withConfig({componentId:"sc-90efecb2-1"})(F()),V=n=>{let{message:e="Nenhum resultado encontrado.",className:t}=n;return(0,i.jsx)(Y,{className:t,children:(0,i.jsx)(q,{children:e})})},W=H.qj,X=H.Z8,A=H.b2,K=H.aV,G=n=>{let{fetchRows:e,rowRenderer:t,filter:r,className:o}=n,[a,s]=(0,O.useState)([]),[c,l]=(0,O.useState)(!0),d=null,u=c?a.length+8:a.length,f=(0,O.useMemo)(()=>new H.t1({fixedWidth:!0,minHeight:50}),[]),h=n=>{let{index:e}=n;return Boolean(a[e])},x=n=>{let{index:e}=n;return a[e]},m=()=>{s([]),l(!0),d&&d.resetLoadMoreRowsCache()},g=n=>{let{startIndex:t,stopIndex:o}=n;return e(t,o-t,r).then(n=>{l(n.length>0),s([...a,...n])})},p=n=>{let{key:e,index:r,parent:o,style:a}=n;return(0,i.jsx)(X,{cache:f,columnIndex:0,rowIndex:r,parent:o,children:e=>{let{measure:r,registerChild:o}=e;return(0,i.jsx)(Z.Z,{onLoad:r,ref:o,style:a,children:t(x(n),h(n),n)})}},e)};return(0,O.useEffect)(()=>{let n=0===Object.keys(r).length;n||m()},[r]),(0,i.jsx)(A,{isRowLoaded:h,loadMoreRows:g,rowCount:u,className:o,ref:n=>{d=n},children:n=>{let{onRowsRendered:e,registerChild:t}=n;return(0,i.jsx)(W,{children:n=>{let{height:r,width:o}=n;return(0,i.jsx)(K,{tabIndex:-1,ref:t,onRowsRendered:e,rowCount:u,noRowsRenderer:()=>(0,i.jsx)(V,{}),rowRenderer:p,deferredMeasurementCache:f,rowHeight:f.rowHeight,height:r,width:o})}})}})};var J=t(475),Q=t(6182),U=t(6204),$=t(7083),nn=t(1568),ne=t(886),nt=t(4384),nr=t(4779),no=t(8365),ni=t(6010);function na(){let n=(0,s.Z)(["\n  &.success {\n    background-color: ",";\n    color: ",";\n\n    .MuiSvgIcon-root {\n      fill: ",";\n    }\n  }\n\n  &.error {\n    background-color: ",";\n    color: ",";\n\n    .MuiSvgIcon-root {\n      fill: ",";\n    }\n  }\n\n  &.info {\n    background-color: ",";\n    color: ",";\n\n    .MuiSvgIcon-root {\n      fill: ",";\n    }\n  }\n\n  &.MuiChip-sizeSmall {\n    && {\n      font-weight: 600;\n      font-size: 0.65rem;\n    }\n  }\n"]);return na=function(){return n},n}function ns(){let n=(0,s.Z)(["\n  && {\n    border-radius: 24px;\n  }\n"]);return ns=function(){return n},n}(r=o||(o={}))[r.default=0]="default",r[r.success=1]="success",r[r.error=2]="error",r[r.info=3]="info",r[r.disabled=4]="disabled";let nc=(0,_.Z)((0,j.ZP)(U.Z).withConfig({componentId:"sc-61a0d18d-0"})(na(),n=>{let{theme:e}=n;return"".concat(e.palette.success.light,"30")},n=>{let{theme:e}=n;return e.palette.success.dark},n=>{let{theme:e}=n;return e.palette.success.dark},n=>{let{theme:e}=n;return"".concat(e.palette.error.light,"30")},n=>{let{theme:e}=n;return e.palette.error.dark},n=>{let{theme:e}=n;return e.palette.error.dark},n=>{let{theme:e}=n;return"".concat(e.palette.info.light,"30")},n=>{let{theme:e}=n;return e.palette.info.dark},n=>{let{theme:e}=n;return e.palette.info.dark})),nl=(0,j.ZP)(no.Z).withConfig({componentId:"sc-61a0d18d-1"})(ns()),nd=n=>{let{label:e,color:t,className:r,loading:a=!1,tooltip:s}=n;if(a)return(0,i.jsx)(nl,{variant:"rect",width:100,height:24});let c=()=>{switch(t){case o.success:return(0,i.jsx)(nn.Z,{});case o.info:return(0,i.jsx)(ne.Z,{});case o.error:return(0,i.jsx)(nt.Z,{});case o.disabled:return(0,i.jsx)(nr.Z,{});default:return null}},l=()=>({default:o.default===t,success:o.success===t,error:o.error===t,info:o.info===t,disabled:o.disabled===t});return s?(0,i.jsx)($.ZP,{title:s,children:(0,i.jsx)(nc,{className:(0,ni.Z)(r,l()),label:e,avatar:c(),size:"small"})}):(0,i.jsx)(nc,{className:(0,ni.Z)(r,l()),label:e,avatar:c(),size:"small"})};var nu=t(4576),nf=t(381),nh=t.n(nf);function nx(){let n=(0,s.Z)(["\n  && {\n    padding: .1rem .5rem;\n    border-radius: 4px;\n    font-weight: 600;\n    text-align: center;\n    font-size: .8rem;\n  }\n  \n  color: rgba(0, 0, 0, 0.87);\n  background-color: #e0e0e0;\n\n  &.success {\n    background-color: ",";\n    color: ",";\n  }\n\n  &.error {\n    background-color: ",";\n    color: ",";\n  }\n\n  &.info {\n    background-color: ",";\n    color: ",";\n  }\n"]);return nx=function(){return n},n}let nm=(0,_.Z)((0,j.ZP)(Z.Z).withConfig({componentId:"sc-6ad37093-0"})(nx(),n=>{let{theme:e}=n;return"".concat(e.palette.success.light,"30")},n=>{let{theme:e}=n;return e.palette.success.dark},n=>{let{theme:e}=n;return"".concat(e.palette.error.light,"30")},n=>{let{theme:e}=n;return e.palette.error.dark},n=>{let{theme:e}=n;return"".concat(e.palette.info.light,"30")},n=>{let{theme:e}=n;return e.palette.info.dark})),ng=n=>{let{label:e,color:t,className:r}=n;return(0,i.jsx)(nm,{className:(0,ni.Z)(r,{default:o.default===t,success:o.success===t,error:o.error===t,info:o.info===t,disabled:o.disabled===t}),children:e})};var nZ=t(9932);function np(){let n=(0,s.Z)(["\n  flex: 0 0 auto;\n  height: 100%;\n"]);return np=function(){return n},n}function nb(){let n=(0,s.Z)(["\n  display: flex;\n  align-items: center;\n  height: 100%;\n  width: 100%;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.1);\n  padding: 1.5rem 2rem;\n\n  "," {\n    flex-direction: column;\n    align-items: stretch;\n  }\n\n  &:hover {\n    background-color: rgba(0, 0, 0, 0.05);\n  }\n"]);return nb=function(){return n},n}function nj(){let n=(0,s.Z)(["\n  display: flex;\n  align-items: center;\n  height: 100%;\n  flex: 1;\n\n  "," {\n    margin-bottom: 0.75rem;\n  }\n"]);return nj=function(){return n},n}function nw(){let n=(0,s.Z)(["\n  && {\n    font-weight: 600;\n    cursor: pointer;\n\n    &:hover {\n      text-decoration: underline;\n    }\n\n    "," {\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n  }\n"]);return nw=function(){return n},n}function nC(){let n=(0,s.Z)(["\n  display: flex;\n  flex-direction: column;\n  padding: 0 0.75rem;\n  flex: 1;\n\n  "," {\n    width: 90%;\n  }\n"]);return nC=function(){return n},n}function nv(){let n=(0,s.Z)(["\n  display: grid;\n  grid-auto-flow: column;\n  grid-gap: 1rem;\n  justify-content: space-between;\n  align-items: center;\n"]);return nv=function(){return n},n}function nI(){let n=(0,s.Z)(["\n  min-width: 48px;\n"]);return nI=function(){return n},n}let nk=(0,j.ZP)(Z.Z).withConfig({componentId:"sc-ceeaa3f1-0"})(np()),nP=(0,_.Z)((0,j.ZP)(Z.Z).withConfig({componentId:"sc-ceeaa3f1-1"})(nb(),n=>{let{theme:e}=n;return e.breakpoints.down("xs")})),ny=(0,_.Z)((0,j.ZP)(Z.Z).withConfig({componentId:"sc-ceeaa3f1-2"})(nj(),n=>{let{theme:e}=n;return e.breakpoints.down("xs")})),nE=(0,_.Z)((0,j.ZP)(h.Z).withConfig({componentId:"sc-ceeaa3f1-3"})(nw(),n=>{let{theme:e}=n;return e.breakpoints.down("xs")})),nN=(0,_.Z)((0,j.ZP)(Z.Z).withConfig({componentId:"sc-ceeaa3f1-4"})(nC(),n=>{let{theme:e}=n;return e.breakpoints.down("xs")})),nR=(0,j.ZP)(Z.Z).withConfig({componentId:"sc-ceeaa3f1-5"})(nv()),nS=(0,j.ZP)(ng).withConfig({componentId:"sc-ceeaa3f1-6"})(nI()),nD=n=>{let{item:e,isRowLoaded:t,addNewEntrance:r,props:{key:a,index:s}}=n;if(!t)return(0,i.jsx)(nk,{children:(0,i.jsxs)(nP,{condensed:!0,children:[(0,i.jsxs)(ny,{children:[(0,i.jsx)(no.Z,{variant:"rect",width:64,height:24}),(0,i.jsx)(nN,{children:(0,i.jsx)(nE,{variant:"body2",children:(0,i.jsx)(no.Z,{variant:"text",width:160})})})]}),(0,i.jsxs)(nR,{children:[(0,i.jsx)(nd,{loading:!0}),(0,i.jsx)(no.Z,{variant:"rect",width:95,height:27})]})]})},"".concat(a,"-").concat(s,"-skeleton"));let{Id:c,Preferential:l,Name:d,SocialName:u,CardNumber:f,EnteredToday:x,LastEntranceDate:m}=e,[g,Z]=(0,O.useState)({LastEntranceDate:m,EnteredToday:x}),p=()=>g.EnteredToday?o.success:null!==g.LastEntranceDate?o.info:o.disabled,b=n=>Z({LastEntranceDate:n.DateTime,EnteredToday:!0}),[j,w]=(0,O.useState)({open:!1,person:null}),C=n=>w({open:!0,person:n}),v=()=>{w({...j,open:!1})};return(0,i.jsxs)(nk,{children:[(0,i.jsxs)(nP,{condensed:!0,children:[(0,i.jsxs)(ny,{children:[(0,i.jsx)(nS,{label:f,color:p()}),(0,i.jsxs)(nN,{children:[(0,i.jsx)(L(),{href:"/pessoas/cadastro/".concat(c),children:(0,i.jsxs)(nE,{variant:"body2",children:[l&&(0,i.jsx)($.ZP,{title:"Preferencial",children:(0,i.jsx)(nu.Z,{style:{fill:"rgb(76, 175, 80)"}})}),d]})}),u&&(0,i.jsx)(h.Z,{variant:"caption",children:u})]})]}),(0,i.jsxs)(nR,{children:[(0,i.jsx)(nd,{label:(()=>{if(null===g.LastEntranceDate)return"Nunca entrou";let n=g.EnteredToday?"Entrou ":"\xdalt. vez ",e=nh()(g.LastEntranceDate).fromNow();return n+e})(),color:p(),tooltip:nh()(g.LastEntranceDate).format("DD/MM/YYYY HH:mm").toString()}),!g.EnteredToday&&(0,i.jsx)(D.Z,{variant:"outlined",size:"small",startIcon:(0,i.jsx)(M.Z,{}),onClick:()=>r(e,b),children:"Entrada"}),(0,i.jsx)(D.Z,{variant:"outlined",size:"small",startIcon:(0,i.jsx)(ne.Z,{}),onClick:async()=>{let n=await N.Z.getPerson(e.Id);C(n)},children:"Cart\xe3o"})]})]}),(0,i.jsx)(nZ.Z,{...j,handleClose:v,newPerson:!1})]},c)};var n_=t(1163);function nM(){let n=(0,s.Z)(["\n  && {\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 0;\n    height: 100%;\n    flex: 1;\n  }\n"]);return nM=function(){return n},n}function nT(){let n=(0,s.Z)([""]);return nT=function(){return n},n}function nL(){let n=(0,s.Z)(["\n  grid-area: add-new;\n  height: 42px;\n"]);return nL=function(){return n},n}function nz(){let n=(0,s.Z)(["\n  && {\n    display: flex;\n    flex-direction: column;\n    margin-bottom: 3rem;\n    flex-shrink: 0;\n    padding: 0;\n  }\n"]);return nz=function(){return n},n}function nO(){let n=(0,s.Z)(["\n  height: 70vh;\n"]);return nO=function(){return n},n}function nH(){let n=(0,s.Z)(["\n  flex: 1;\n"]);return nH=function(){return n},n}function nB(){let n=(0,s.Z)(["\n  margin-left: 1rem;\n"]);return nB=function(){return n},n}function nF(){let n=(0,s.Z)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1.5rem 2rem;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.1);\n  box-shadow: ",";\n"]);return nF=function(){return n},n}function nY(){let n=(0,s.Z)(["\n  flex: 1;\n  max-width: 400px;\n"]);return nY=function(){return n},n}let nq=(0,j.ZP)(S.Z).withConfig({componentId:"sc-b17d83b0-0"})(nM()),nV=(0,_.Z)((0,j.ZP)(J.Z).withConfig({componentId:"sc-b17d83b0-1"})(nT())),nW=(0,j.ZP)(D.Z).withConfig({componentId:"sc-b17d83b0-2"})(nL()),nX=(0,j.ZP)(c.Z).withConfig({componentId:"sc-b17d83b0-3"})(nz()),nA=(0,j.ZP)(Z.Z).withConfig({componentId:"sc-b17d83b0-4"})(nO()),nK=(0,j.ZP)(G).withConfig({componentId:"sc-b17d83b0-5"})(nH()),nG=(0,j.ZP)(Q.Z).withConfig({componentId:"sc-b17d83b0-6"})(nB()),nJ=(0,j.ZP)(Z.Z).withConfig({componentId:"sc-b17d83b0-7"})(nF(),R.fo.bottom),nQ=(0,j.ZP)(k).withConfig({componentId:"sc-b17d83b0-8"})(nY()),nU=()=>{let{enqueueSnackbar:n}=(0,z.Ds)(),e=(0,n_.useRouter)(),[t,r]=(0,O.useState)({});(0,O.useEffect)(()=>r({nameOrCardNumber:e.query.q}),[]);let[o,a]=(0,O.useState)(),[s,c]=(0,O.useState)(),[l,d]=(0,O.useState)(!1),[u,f]=(0,O.useState)({title:"Confirmar entrada",open:!1}),h=(n,e,t)=>N.Z.get(n,e,t),x=()=>P.Z.getToday().then(n=>{let{entrances:e,registers:t}=n;a(e),c(t)}),m=n=>r({nameOrCardNumber:n}),Z=(n,e)=>{let t="Deseja confirmar a entrada de **".concat(n.Name," (").concat(n.CardNumber,")**?");f({...u,data:{person:n,callback:e},message:t,open:!0})},p=()=>{var n;f({...u,open:!1}),null===(n=document.getElementById("search-field"))||void 0===n||n.focus()},b=()=>{d(!0),E.post(u.data.person).then(e=>{let{status:t,data:r}=e;200===t?(p(),u.data.callback(r),x(),d(!1)):(n("Ocorreu um erro ao confirmar a entrada.",{variant:"error"}),d(!1))})};(0,O.useEffect)(()=>{x()},[]);let j=(n,e,t)=>(0,i.jsx)(nD,{item:n,isRowLoaded:e,props:t,addNewEntrance:Z});return(0,i.jsxs)(nq,{children:[(0,i.jsx)(nV,{title:"Pessoas",sideComponent:(0,i.jsx)(L(),{href:"/pessoas/cadastro",children:(0,i.jsx)(nW,{variant:"contained",startIcon:(0,i.jsx)(M.Z,{}),children:"Nova Pessoa"})})}),(0,i.jsxs)(nX,{children:[(0,i.jsxs)(nJ,{children:[(0,i.jsx)(nQ,{placeholder:"Nome ou cart\xe3o",onFilter:m}),(0,i.jsx)(nG,{value:null!=o?o:"-",label:"entradas hoje",medium:!0,alignRight:!0}),(0,i.jsx)(nG,{value:null!=s?s:"-",label:"cadastros hoje",medium:!0,alignRight:!0})]}),(0,i.jsx)(nA,{children:(0,i.jsx)(nK,{fetchRows:h,rowRenderer:j,filter:t})})]}),(0,i.jsx)(g,{...u,handleClose:p,actions:(0,i.jsx)(D.Z,{autoFocus:!0,onClick:b,color:"primary",disabled:l,children:"Confirmar"})})]})},n$=()=>(0,i.jsx)(a.Z,{title:"Pessoas - Canto da Rua",children:(0,i.jsx)(nU,{})});var n0=n$}},function(n){n.O(0,[169,585,575,24,338,711,701,82,733,774,888,179],function(){return n(n.s=7288)}),_N_E=n.O()}]);